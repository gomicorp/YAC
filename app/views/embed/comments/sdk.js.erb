function loadScript(id, src, callback) {
  var existingScript = document.getElementById(id);

  if (!existingScript) {
    var insertPoint = document.getElementsByTagName('script')[0];
    var scriptTag = document.createElement('script');
    scriptTag.src = src;
    scriptTag.onload = function() {
      if (callback) callback();
      if (!id) scriptTag.remove();
    };
    scriptTag.async = true;
    insertPoint.parentNode.insertBefore(scriptTag, insertPoint);
  }

  if (existingScript && callback) callback();
}

window.YACHost = '<%= (browser.chrome? && Rails.env.development?) ? 'http://localhost:3000/' : root_url %>';


/**
 * Import & Initialize Attention module.
 */
loadScript('YAC-sdk', '<%= asset_pack_url 'sdk.js' %>', function() {
  // It won't be fixed for conditional clause.
  // This is able to show to the client debug tools or others.
  // So the factors except api key, must keep hide their intent.
  YAC.commentSdk.render('<%= params[:api_key] %>', '<%= @admin_access ? @site.domain : '' %>', '<%= @admin_access ? @post.identifier : '' %>');
});
